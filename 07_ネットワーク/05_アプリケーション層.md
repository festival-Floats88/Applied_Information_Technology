# **5. アプリケーション層**

## **1. WWW**(World Wide Web)

**WWW**は, インターネットにおいて最も多く利用されるサービスの1つで, ブラウザとWWWサーバの間でHTML文書をやりとりする. このやりとりに用いるプロトコルがHTTPである.

### **URL**(Uniform Resource Locator)

**URL**は, HTML文書を含め, `インターネット上のリソースを指定する書式`である. URLでは, リソースにアクセスするための**スキーム**(プロトコル), サーバ名(IPアドレスも可), ディレクトリ名, ファイル, ポート番号などが指定される.

### **HTTP**(HyperText Transfer Protocol)

**HTTP**は, クライアントの要求に対して, WWWサーバが要求に基づいたリソースを送信するプロトコルである. リソースは, HTML文書のほか, 画像ファイルや実行ファイル, 音楽ファイルなどであっても構わない.

**HTTPS**は, **SSL**による暗号化通信を実装した「HTTPのセキュリティ強化版」である.

### **CGI**(Common Gateway Interface)

**CGI**は, WWWサーバがブラウザの要求に応じて`プログラムを起動するための仕組み`である. ブラウザがURLにCGIを指定してWWWサーバにアクセスすると, サーバ側でアプリケーションプログラムが起動され, その処理結果がブラウザに返ってくる.

## **2. 電子メール**

**電子メール**は, WWWと並ぶインターネットの代表的なサービスである. 電子メールサービスを実現するため, 次のプロトコルが用いられる.

| 名称 | 説明 |
| --: | :-- |
| SMTP | 電子メールの転送プロトコルで, メールサーバへの送信, サーバ間のメール転送に用いる |
| POP | 電子メールの受信に用いるプロトコルで, 受信メールはクライアントにダウンロードされ, `クライアント上で管理`される |
| IMAP | 電子メールの受信に用いるプロトコルで, POPとは異なり, `メールはサーバ上で管理`される |

## **3. DNS**(Domain Name System)

URLやメールアドレスなどの, ホストの指定には**ホスト名**(**ドメイン名**)を使う. これを, ホストを表すIPアドレスに変換する(名前を解決する)ことが**DNS**の役割である.

名前解決を行う場合, クライアントはまず「自ドメインのDNSサーバ」に対して問い合わせを行う. このとき, 問い合わせの対象となるドメイン名が自ドメインのものであれば, 自ドメインのDNSサーバが直接返答することになる.

一方, 目的のドメイン名が他ドメインに属する場合, 自ドメインのDNSサーバは**ルートドメイン**から下位のドメインに向かって順に検索を繰り返し, 目的のIPアドレスを取得してクライアントに返答する.

## **4. SNMP**(Simple Network Management Protocol)

**SNMP**はTCP/IPにおける`通信機器を管理する`ためのプロトコルである. SNMPでは, 管理する側を「**マネージャ**」, 管理される側を「**エージェント**」という.

エージェントは**MIB**(Management Information Base)と呼ばれる, 管理される項目の集合を持ち, マネージャの指示によって設定変更や情報の通知を行う.

SNMPに特有の**トラップ**という機能もある. これは, エージェントに特定のイベントが発生した場合に, `自律的にマネージャに通知する`機能である.

## **5. DHCP**(Dynamic Host Configuration Protocol)

### **1. DHCPと設定情報**

**DHCP**は, IPアドレス, サブネットマスク, デフォルトゲートウェイ, DNSサーバといった`ネットワーク接続に必要な設定を自動化する`プロトコルである. DHCPを利用することにより, 管理者の設定負荷の軽減や設定情報の一元管理などが可能となる.

DHCPでは, DHCPクライアントは起動直後にDHCPサーバに対して設定情報を要求し, その要求を受けたDHCPサーバは, 適切な設定情報を返す.

### **2. DHCPの通信シークエンス**

DHCPクライアントとDHCPサーバ間で行われるやり取りを, 詳しく見ていく.

DHCPでは, DHCPクライアントがDHCPサーバに設定情報の割り当てを要求すると, ブロードキャストを用いて次のようなメッセージがやり取りされる.

1. DHCPクライアントは**DHCPDISCOVERメッセージ**をブロードキャストする
2. DHCPDISCOVERメッセージを受け取ったDHCPサーバは, 使用可能なIPアドレスを含む**DHCPOFFERメッセージ**で応答し, 同一サブネット中に複数のDHCPサーバがあれば, 複数のDHCPOFFERメッセージがDHCPクライアントに返送される
3. DHCPクライアントは, 返されたDHCPOFFERメッセージの中から1つを選択し, **DHCPQUESTメッセージ**を送信する
4. DHCPQUESTメッセージを受け取ったDHCPサーバーは, **DHCPPACK**を返してそのIPアドレスを使用済みとする
5. DHCPPACKメッセージを受け取ったDHCPクライアントは, その構成情報を適用する

### **3. アドレスプールとリース期間**

DHCPサーバが割り当てるIPアドレスには, **リース期間**が設定される. また, DHCPサーバには「`割り当て可能なIPアドレスの範囲`」が設定される. これを**アドレスプール**という.

DHCPサーバは, アドレスプールの中から割り当て可能なアドレスをクライアントに割り当て, リース期限の切れたIPアドレスを回収する. またクライアントは, IPアドレスのリース期限が切れる前に, リース期限の延長をDHCPサーバに要求することもできる.

### **4. リレーエージェント**

DHCPクライアントは, IPアドレスを割り当てられていない状態で通信を行うため, ブロードキャストを使用する. ただし, ブロードキャストはサブネットを超えることができないので, 通常はサブネット毎に1台のDHCPサーバが必要となる.

サブネットを超えた位置にDHCPサーバを設置したい場合は, DHCPメッセージを中継する**DHCPリレーエージェント**が必要になる. DHCPリレーエージェントにはDHCPサーバの位置が登録されており, クライアントからの要求をDHCPサーバに転送する

## **5. その他のプロトコル**

| 名称 | 正式名称 | 説明 |
| --: |:--  | :-- |
| FTP | File Transfer Protocol | ファイル転送に用いるプロトコル |
| NTP | Network Time Protocol | 時刻を同期するプロトコル |
| SIP | Session Initiation Protocol | セッションの確立に用いるプロトコル |
